<!DOCTYPE html>
<html lang="en"><!-- Basic -->
<head>
    <base target="_top">
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">   
   
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
 
     <!-- Site Metas -->
	 <title>Géoportail Des Parcs Nationaux</title>  
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="Image/palmicon.png" >
    <link rel="apple-touch-icon" href="Image/">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="Css/bootstrap.min.css">    
	<!-- Site CSS -->
    <link rel="stylesheet" href="Css/style.css">    
	<!-- Pickadate CSS -->
    <link rel="stylesheet" href="Css/classic.css">    
	<link rel="stylesheet" href="Css/classic.date.css">    
	<link rel="stylesheet" href="Css/classic.time.css">    
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="Css/responsive.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="Css/custom.css">

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  
	<!-- Load jQuery and PapaParse to read data from a CSV file -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>


	<title>Layers Control Tutorial - Leaflet</title>
						
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="Css/leaflet.css"/>
    <script src="Js/leaflet.js"></script>
    <link rel="stylesheet" href="Css/leaflet.zoomhome.css"/>
    <script src="Js/leaflet.zoomhome.min.js"></script>
	 <!-- Load Leaflet from CDN -->
	 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" crossorigin="" />
	 <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js" crossorigin=""></script>
 
	 <!-- Load Esri Leaflet from CDN -->
	 <script src="https://unpkg.com/esri-leaflet@^3.0.8/dist/esri-leaflet.js"></script>
	 <script src="https://unpkg.com/esri-leaflet-vector@4.0.0/dist/esri-leaflet-vector.js"></script>

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>
	<!-- Start header -->
	<header class="top-navbar">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<div class="container">
				<a class="navbar-brand" href="index.html">
					<img src="images/logogeotourisme.png" alt="" />
				</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbars-rs-food" aria-controls="navbars-rs-food" aria-expanded="false" aria-label="Toggle navigation">
				  <span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbars-rs-food">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item"><a class="nav-link" href="index.html">Accueil</a></li>
						<li class="nav-item"><a class="nav-link" href="about.html">Informations</a></li>
						<li class="nav-item"><a class="nav-link" href="storymap\index1.html">Géoportail</a> </li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Cartes thématiques</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="Carte des superficies.html">Carte des superficies</a>
								<a class="dropdown-item" href="Carte NDVI.html">Carte NDVI</a>
								<a class="dropdown-item" href="Visualisation 3D.html" target="_blank">Visualisation 3D</a>
							</div>
                        </li>

						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Recherche</a>
							<div class="dropdown-menu" aria-labelledby="dropdown-a">
								<a class="dropdown-item" href="Recherche.html">Attributaires</a>
								<a class="dropdown-item" href="Recherche2.html">Spatiales</a>
								<a class="dropdown-item" href="Itinéraire.html">Itinéraire</a>
							</div>
						</li>
							<li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
	<!-- End header -->
	
	<!-- Start All Pages -->
	<div class="all-page-title page-breadcrumb">
		<div class="container text-center">
			<div class="row">
				<div class="col-lg-12">
					<h1>Recherche</h1>
					<br><br>
				</div>
			</div>
		</div>
	</div>
	<!-- End All Pages -->
	<div class="blog-box">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="heading-title text-center">
						<br><br>
						<p>  </p>
							<head>
							  <style>
								#map {
								  height: 500px ;
                                  width: 1000px;
								  font-family: Arial, Helvetica, sans-serif;
								  font-size: 14px;
								  color: #323232;
								  display: block;
                                  margin-left: auto;
                                  margin-right: auto;
								  padding: 100px
								}
								#panel {
									position: absolute;
    top: 5%;
    left: 50%;
	background: white;
    transform: translateX(-50%) translateY(-50%);
	padding: 4px;
        }
							  </style>
                         </head>
					
						    <body>
								<div id="map" class="map"></div>
								<div id="panel" class="leaflet-bar" >
									Parc National de Toubkal
									<select name="relation" id="relationSelect">
									  <option value="within">Within<options>
									  <option value="contains">Contains<options>
									  <option value="intersects">Intersects<options>
									  <option value="overlaps">Overlaps<options>
									</select>
									<select name="geometry" id="geometrySelect">
									  <option value="point">Djbel Toubkal<options>
									  <option value="line">Route N°2030<options>
									  <option value="polygon">Ifni<options>
									</select>
									<button id="executeQuery">Run Query</button>
								  </div>
							  <script>

								const map = L.map("map", {minZoom: 5}).setView([31.061762211372717, -7.914919899573209], 11);
								const apiKey = "AAPK22b2239330f348e6856b49ba92d3aa36l-qSfkzwWqJOSvuCHty6k4cDtOREFtSJoPiRlta-1uwftZL9sBYHbKzcDXjD4ZK5";
								const basemapLayers = {Streets: L.esri.Vector.vectorBasemapLayer("ArcGIS:Topographic", { apiKey: apiKey }).addTo(map)

      };
	  var Maroc = L.esri
        .featureLayer({
          url: "https://services6.arcgis.com/f4ktY2fh4AlEsjcx/arcgis/rest/services/maroc/FeatureServer/0",
		  style: {
            color: "#000000",
            weight: 5
        }});

var Toubkal = L.esri
        .featureLayer({
          url: "https://services6.arcgis.com/f4ktY2fh4AlEsjcx/arcgis/rest/services/toubkal/FeatureServer/0",
		  style: {
            color: "#000000",
            weight: 5
        }});
        
Toubkal.addTo(map);

const icon = L.icon({
        iconUrl: "https://mrbourriz.github.io/Sommet.png/mountain.png",
        iconSize: [27, 31],
        iconAnchor: [13.5, 17.5],
        popupAnchor: [0, -11]
      });


const Sommet = L.marker([31.060090584371125, -7.914748488270757 ], {icon: icon}).addTo(map);

const Route = L.polyline([ // Create a line to query against
        [31.138,-7.917],
        [31.132,-7.921],
		[31.124,-7.920],
		[31.123,-7.920],
		[31.117,-7.920],
		[31.116,-7.920],
		[31.111,-7.919],
		[31.107,-7.916]
      ], {
        color: 'red',
        weight: 3
      }).addTo(map);

	  const Ifni = L.polygon([ // Create a polygon to query against
        [31.028, -7.888],
        [31.029, -7.888],
        [31.032, -7.888],
        [31.032, -7.887],
		[31.033, -7.885],
		[31.033, -7.880],
		[31.033, -7.879],
		[31.031, -7.880],
		[31.030, -7.881],
		[31.029, -7.883],
		[31.029, -7.884],
		[31.028, -7.888],
		[31.028, -7.888]
      ], {
        color: 'blue',
        weight: 5
      }).addTo(map);
	  const geometries = {
        line: Route,
        point: Sommet,
		polygon: Ifni

      };
	  const relationship = document.getElementById('relationSelect');
      const geometry = document.getElementById('geometrySelect');
      const runQueryButton = document.getElementById('executeQuery');
      let previousIds = [];

      function reset () {  // Reset all features back to their regularly defined styles
        for (let i = previousIds.length - 1; i >= 0; i--) {
          Toubkal.resetStyle(previousIds[i]);
        }
    }

      function query () {
        reset();
        const inputGeometry = geometries[geometry.value];
        Toubkal.query()[relationship.value](inputGeometry).ids(function (error, ids) {
          if (error) {
            console.log('Error with query: ' + error);
          } else if (ids) {
            previousIds = ids;
            for (let i = ids.length - 1; i >= 0; i--) {
              Toubkal.setFeatureStyle(ids[i], { color: 'green', weight: 4 });
            }
          } 
        });
      }

      runQueryButton.addEventListener('click', query);

      Toubkal.once('load', function () {
        query();
	  });
</script>
							  
	<a href="#" id="back-to-top" title="Back to top" style="display: none;">&uarr;</a>

	<!-- ALL JS FILES -->
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
	<script src="js/jquery.superslides.min.js"></script>
	<script src="js/images-loded.min.js"></script>
	<script src="js/isotope.min.js"></script>
	<script src="js/form-validator.min.js"></script>
    <script src="js/contact-form-script.js"></script>
    <script src="js/custom.js"></script>
</body>
</html>